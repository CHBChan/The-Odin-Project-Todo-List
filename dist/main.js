(()=>{function e(){return document.querySelector(".project_title")?document.querySelector(".project_title").innerHTML:document.querySelector(".name_input").value}function t(){let t=e();return s.findIndex((e=>e.getTitle()===t))}function l(e){let t=document.querySelector(".form_name");v.style.display="flex",_.style.display="none",k.style.display="none","project"===e?(t.innerHTML="Create new project",_.style.display="flex"):"task"===e?(t.innerHTML="Create new task",k.style.display="flex"):console.error("Strange occurrence in showForm().")}function n(){let e={};s.forEach((t=>{e[t.getTitle()]=t.toJSON()})),localStorage.setItem("project_list",JSON.stringify(e))}function r(){v.style.display="none"}function a(){let e=document.querySelector(".project_name"),t=document.querySelector(".task_name"),l=document.querySelector(".task_desc"),n=document.querySelector(".due_date"),r=document.querySelector(".priority");e.value="",t.value="",l.value="",n.value="",r.value=""}function i(){let e=document.querySelector(".project_list");e.innerHTML="",s.forEach((t=>{let l=document.createElement("a");l.setAttribute("class","project-"+t.getTitle()),l.innerHTML=t.getTitle(),l.addEventListener("click",(e=>{c(e.target.className.replace("project-",""))})),e.appendChild(l)}))}function c(r){let a=document.querySelector(".content"),d=s.findIndex((e=>e.getTitle()===r));a.innerHTML="";let o=document.createElement("div");o.setAttribute("class","project_header");let u=document.createElement("div");u.setAttribute("class","wrapper");let m=document.createElement("p");m.setAttribute("class","project_title"),m.innerHTML=r;let p=document.createElement("i");p.setAttribute("class","material-icons"),p.innerHTML="edit",p.addEventListener("click",(()=>{if("edit"===p.innerHTML){p.innerHTML="save";let e=document.createElement("input");e.setAttribute("class","name_input"),e.value=m.innerHTML,m.replaceWith(e)}else{let e=document.querySelector(".name_input");s.findIndex((t=>t.getTitle()===e.value))===d||-1===s.findIndex((t=>t.getTitle()===e.value))?(p.innerHTML="edit",s[d].editTitle(e.value),c(e.value),i(),n()):alert("This project name already exists.")}})),u.appendChild(m),u.appendChild(p);let y=document.createElement("i");y.setAttribute("class","material-icons"),y.innerHTML="delete",y.addEventListener("click",(()=>{s.splice(d,1),i(),a.innerHTML="",n()})),o.appendChild(u),o.appendChild(y),a.append(o);let T=document.createElement("button");T.setAttribute("class","material-icons add_task"),T.innerHTML="add",T.addEventListener("click",(()=>{l("task")})),a.append(T),function(){let l=t(),r=e(),a=document.querySelector(".content");s[l].getTasks().forEach((e=>{let i=document.createElement("div");i.setAttribute("class","task-"+e.getTitle());let d=document.createElement("i");d.setAttribute("class","material-icons"),e.getCompletion()?d.innerHTML="check_box":d.innerHTML="check_box_outline_blank",d.addEventListener("click",(()=>{d.innerHTML="check_box",e.completeTask(),n()}));let o=document.createElement("div");o.setAttribute("class","task_item_name_desc");let u=document.createElement("p");if(u.setAttribute("class","task_item_name"),u.innerHTML=e.getTitle(),o.appendChild(u),e.getDesc()){let t=document.createElement("p");t.setAttribute("class","task_item_desc"),t.innerHTML=e.getDesc(),o.appendChild(t)}let m=document.createElement("p");m.setAttribute("class","task_item_due_date"),m.innerHTML=`Due: ${e.getDueDate()}`,i.classList.add(e.getPriority());let p=document.createElement("i");p.setAttribute("class","material-icons"),p.innerHTML="edit",p.addEventListener("click",(()=>{!function(e,l,n,r,a){let i=document.querySelector(".edit_modal"),c=t(),d=document.querySelector(".edit_task_name"),o=document.querySelector(".edit_task_desc"),s=document.querySelector(".edit_due_date"),u=document.querySelector(".edit_priority");d.value=l,o.value=n,s.value=r,u.value=a,i.style.display="flex",f=((e,t)=>({getProjectIdx:()=>e,getTaskIdx:()=>t}))(c,e)}(s[l].findTaskIndex(e.getTitle()),e.getTitle(),e.getDesc(),e.getDueDate(),e.getPriority())}));let y=document.createElement("i");y.setAttribute("class","material-icons"),y.classList.add("right"),y.innerHTML="close",y.addEventListener("click",(()=>{s[l].removeTask(e.getTitle()),c(r),n()})),i.appendChild(d),i.appendChild(o),i.appendChild(m),i.appendChild(p),i.appendChild(y),a.appendChild(i)}))}()}const d=e=>{let t=[];return{getTitle:()=>e,getTasks:()=>t,addTask:(e,l,n,r,a=!1)=>{let i=o(e,l,n,r,a);t.push(i)},removeTask:e=>{let l=t.findIndex((t=>t.getTitle()===e));t.splice(l,1)},findTask:e=>t.find((t=>t.getTitle()===e)),findTaskIndex:e=>t.findIndex((t=>t.getTitle()===e)),editTitle:t=>{e=t},editTask:(e,l,n,r,a)=>{t[e].editTask(l,n,r,a)},toJSON:()=>{let e={};return t.forEach((t=>{e[t.getTitle()]=t.toJSON()})),e}}},o=(e,t,l,n,r=!1)=>{let a=r;const i=()=>e,c=()=>t,d=()=>l,o=()=>n,s=()=>a;return{getTitle:i,getDesc:c,getDueDate:d,getPriority:o,getCompletion:s,completeTask:()=>{a=!0},editTask:(r,a,i,c)=>{r&&i&&c&&(e=r,t=a,l=i,n=c)},toJSON:()=>({title:i(),desc:c(),dueDate:d(),priority:o(),complete:s()})}};let s=[];if(localStorage.project_list){let e=JSON.parse(localStorage.getItem("project_list"));for(const[t,l]of Object.entries(e)){let e=d(t);for(const[t,n]of Object.entries(l))e.addTask(n.title,n.desc,n.dueDate,n.priority,n.complete);s.push(e)}i()}else console.log("no list found"),s=[];let u=document.querySelector(".expand"),m=document.querySelector(".sidebar"),p=document.querySelector(".content"),y="250px",T=!1;u.addEventListener("click",(()=>{T?(m.style.width=0,p.style.marginLeft=0):(m.style.width=y,p.style.marginLeft=y),T=!T}));let v=document.querySelector(".modal"),_=document.querySelector(".project_form"),k=document.querySelector(".task_form");v.addEventListener("click",(e=>{"modal"===e.target.className&&(r(),a())})),document.querySelector(".add_project").addEventListener("click",(()=>{l("project")})),document.querySelector(".submit").addEventListener("click",(()=>{if("none"!=_.style.display){let e=document.querySelector(".project_name").value;if(e.length<1)return void alert("The project name must have at least one character.");if(s.find((t=>t.getTitle()===e)))return void alert("This project name already exists.")}else if("none"!=k.style.display){let e=t(),l=document.querySelector(".task_name").value,n=document.querySelector(".due_date").value,r=document.querySelector(".priority").value;if(l.length<1)return void alert("The task name must have at least one character.");if(s[e].findTask(l))return void alert("This task name already exists in this project.");if(!isNaN(n))return void alert("The date entered is invalid.");if(!r)return void alert("Please select the task priority.")}!function(){if("none"!=_.style.display){let e=document.querySelector(".project_name").value,t=d(e);s.push(t),i()}else if("none"!=k.style.display){let l=t(),n=document.querySelector(".task_name").value,r=document.querySelector(".task_desc").value,a=document.querySelector(".due_date").value,i=document.querySelector(".priority").value;s[l].addTask(n,r,a,i),c(e())}else console.error("Strange occurrence in createNew().");r(),a()}(),n()}));let f,S=document.querySelector(".edit_modal");S.addEventListener("click",(e=>{if("edit_modal"===e.target.className){let e=document.querySelector(".edit_task_name"),t=document.querySelector(".edit_task_desc"),l=document.querySelector(".edit_due_date"),n=document.querySelector(".edit_priority");e.value="",t.value="",l.value="",n.value="",S.style.display="none"}})),document.querySelector(".edit_submit").addEventListener("click",(()=>{let l=t(),r=document.querySelector(".edit_task_name"),a=document.querySelector(".edit_task_desc"),i=document.querySelector(".edit_due_date"),d=document.querySelector(".edit_priority");r.value.length<1?alert("The task name must have at least one character."):s[l].findTask(r.value)?alert("This task name already exists in this project."):isNaN(i.value)?d.value?(function(t,l,n,r,a,i){let d=document.querySelector(".edit_modal");s[t].editTask(l,n.value,r.value,a.value,i.value),d.style.display="none",n.value="",r.value="",a.value="",i.value="",c(e())}(f.getProjectIdx(),f.getTaskIdx(),r,a,i,d),n()):alert("Please select the task priority."):alert("The date entered is invalid.")}))})();