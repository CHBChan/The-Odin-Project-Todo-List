(()=>{function e(){return document.querySelector(".project_title")?document.querySelector(".project_title").innerHTML:document.querySelector(".name_input").value}function t(){let t=e();return s.findIndex((e=>e.getTitle()===t))}function l(e){let t=document.querySelector(".form_name");v.style.display="flex",T.style.display="none",k.style.display="none","project"===e?(t.innerHTML="Create new project",T.style.display="flex"):"task"===e?(t.innerHTML="Create new task",k.style.display="flex"):console.error("Strange occurrence in showForm().")}function n(){localStorage.setItem("project_list",JSON.stringify(s)),console.log(s)}function r(){v.style.display="none"}function a(){let e=document.querySelector(".project_name"),t=document.querySelector(".task_name"),l=document.querySelector(".task_desc"),n=document.querySelector(".due_date"),r=document.querySelector(".priority");e.value="",t.value="",l.value="",n.value="",r.value=""}function i(){let e=document.querySelector(".project_list");e.innerHTML="",s.forEach((t=>{console.log(t);let l=document.createElement("a");l.setAttribute("class","project-"+t.getTitle()),l.innerHTML=t.getTitle(),l.addEventListener("click",(e=>{d(e.target.className.replace("project-",""))})),e.appendChild(l)}))}function c(){let e=t(),l=document.querySelector(".content");s[e].getTasks().forEach((n=>{let r=document.createElement("div");r.setAttribute("class","task-"+n.getTitle());let a=document.createElement("i");a.setAttribute("class","material-icons"),n.getCompletion()?a.innerHTML="check_box":a.innerHTML="check_box_outline_blank",a.addEventListener("click",(()=>{a.innerHTML="check_box",n.completeTask()}));let i=document.createElement("div");i.setAttribute("class","task_item_name_desc");let c=document.createElement("p");if(c.setAttribute("class","task_item_name"),c.innerHTML=n.getTitle(),i.appendChild(c),n.getDesc()){let e=document.createElement("p");e.setAttribute("class","task_item_desc"),e.innerHTML=n.getDesc(),i.appendChild(e)}let o=document.createElement("p");o.setAttribute("class","task_item_due_date"),o.innerHTML=`Due: ${n.getDueDate()}`,r.classList.add(n.getPriority());let u=document.createElement("i");u.setAttribute("class","material-icons"),u.innerHTML="edit",u.addEventListener("click",(()=>{!function(e,l,n,r,a){let i=document.querySelector(".edit_modal"),c=t(),d=document.querySelector(".edit_task_name"),o=document.querySelector(".edit_task_desc"),s=document.querySelector(".edit_due_date"),u=document.querySelector(".edit_priority");d.value=l,o.value=n,s.value=r,u.value=a,i.style.display="flex",g=((e,t)=>({getProjectIdx:()=>e,getTaskIdx:()=>t}))(c,e)}(s[e].findTaskIndex(n.getTitle()),n.getTitle(),n.getDesc(),n.getDueDate(),n.getPriority())}));let m=document.createElement("i");m.setAttribute("class","material-icons"),m.classList.add("right"),m.innerHTML="close",m.addEventListener("click",(()=>{s[e].removeTask(n.getTitle()),d(title)})),r.appendChild(a),r.appendChild(i),r.appendChild(o),r.appendChild(u),r.appendChild(m),l.appendChild(r)}))}function d(e){let t=document.querySelector(".content"),r=s.findIndex((t=>t.getTitle()===e));t.innerHTML="";let a=document.createElement("div");a.setAttribute("class","project_header");let o=document.createElement("div");o.setAttribute("class","wrapper");let u=document.createElement("p");u.setAttribute("class","project_title"),u.innerHTML=e;let m=document.createElement("i");m.setAttribute("class","material-icons"),m.innerHTML="edit",m.addEventListener("click",(()=>{if("edit"===m.innerHTML){m.innerHTML="save";let e=document.createElement("input");e.setAttribute("class","name_input"),e.value=u.innerHTML,u.replaceWith(e)}else{let e=document.querySelector(".name_input");s.findIndex((t=>t.getTitle()===e.value))===r||-1===s.findIndex((t=>t.getTitle()===e.value))?(m.innerHTML="edit",s[r].editTitle(e.value),d(e.value),i(),n()):alert("This project name already exists.")}})),o.appendChild(u),o.appendChild(m);let p=document.createElement("i");p.setAttribute("class","material-icons"),p.innerHTML="delete",p.addEventListener("click",(()=>{s.splice(r,1),i(),t.innerHTML=""})),a.appendChild(o),a.appendChild(p),t.append(a);let y=document.createElement("button");y.setAttribute("class","material-icons add_task"),y.innerHTML="add",y.addEventListener("click",(()=>{l("task")})),t.append(y),c()}const o=(e,t,l,n)=>{let r=!1;return{getTitle:()=>e,getDesc:()=>t,getDueDate:()=>l,getPriority:()=>n,getCompletion:()=>r,completeTask:()=>{r=!0},editTask:(r,a,i,c)=>{r&&i&&c&&(e=r,t=a,l=i,n=c)}}};let s;localStorage.clear(),localStorage.project_list?(console.log("list retrieved"),s=JSON.parse(localStorage.getItem("project_list")),i()):(console.log("no list found"),s=[]);let u=document.querySelector(".expand"),m=document.querySelector(".sidebar"),p=document.querySelector(".content"),y="250px",_=!1;u.addEventListener("click",(()=>{_?(m.style.width=0,p.style.marginLeft=0):(m.style.width=y,p.style.marginLeft=y),_=!_}));let v=document.querySelector(".modal"),T=document.querySelector(".project_form"),k=document.querySelector(".task_form");v.addEventListener("click",(e=>{"modal"===e.target.className&&(r(),a())})),document.querySelector(".add_project").addEventListener("click",(()=>{l("project")})),document.querySelector(".submit").addEventListener("click",(()=>{if("none"!=T.style.display){let e=document.querySelector(".project_name").value;if(e.length<1)return void alert("The project name must have at least one character.");if(s.find((t=>t.getTitle()===e)))return void alert("This project name already exists.")}else if("none"!=k.style.display){let e=t(),l=document.querySelector(".task_name").value,n=document.querySelector(".due_date").value,r=document.querySelector(".priority").value;if(l.length<1)return void alert("The task name must have at least one character.");if(s[e].findTask(l))return void alert("This task name already exists in this project.");if(!isNaN(n))return void alert("The date entered is invalid.");if(!r)return void alert("Please select the task priority.")}!function(){if("none"!=T.style.display){let e=(e=>{let t=[];return{getTitle:()=>e,getTasks:()=>t,addTask:(e,l,n,r)=>{let a=o(e,l,n,r);t.push(a)},removeTask:e=>{let l=t.findIndex((t=>t.getTitle()===e));t.splice(l,1)},findTask:e=>t.find((t=>t.getTitle()===e)),findTaskIndex:e=>t.findIndex((t=>t.getTitle()===e)),editTitle:t=>{e=t},editTask:(e,l,n,r,a)=>{t[e].editTask(l,n,r,a)}}})(document.querySelector(".project_name").value);s.push(e),i()}else if("none"!=k.style.display){let l=t(),n=document.querySelector(".task_name").value,r=document.querySelector(".task_desc").value,a=document.querySelector(".due_date").value,i=document.querySelector(".priority").value;s[l].addTask(n,r,a,i),d(e())}else console.error("Strange occurrence in createNew().");r(),a()}(),n()}));let g,S=document.querySelector(".edit_modal");S.addEventListener("click",(e=>{if("edit_modal"===e.target.className){let e=document.querySelector(".edit_task_name"),t=document.querySelector(".edit_task_desc"),l=document.querySelector(".edit_due_date"),n=document.querySelector(".edit_priority");e.value="",t.value="",l.value="",n.value="",S.style.display="none"}})),document.querySelector(".edit_submit").addEventListener("click",(()=>{let t=document.querySelector(".edit_task_name"),l=document.querySelector(".edit_task_desc"),r=document.querySelector(".edit_due_date"),a=document.querySelector(".edit_priority");!function(t,l,n,r,a,i){let c=document.querySelector(".edit_modal");s[t].editTask(l,n.value,r.value,a.value,i.value),c.style.display="none",n.value="",r.value="",a.value="",i.value="",d(e())}(g.getProjectIdx(),g.getTaskIdx(),t,l,r,a),n()}))})();